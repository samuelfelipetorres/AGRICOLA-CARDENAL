<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Resumen General</title>

    <!-- Tailwind y Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #111827;
            color: #f9fafb;
        }
        .card {
            background: #1f2937;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-3px); }
        canvas { max-height: 320px; }
    </style>
</head>
<body class="min-h-screen py-10 px-6">

    <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-10">Resumen General</h1>

        <!-- Tarjetas principales -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            {% for fila in tabla_general_total %}
            <div class="card text-center">
                <h3 class="text-gray-400 text-sm">Total HW</h3>
                <p class="text-2xl font-bold text-blue-400">{{ "%.2f"|format(fila.HW) }}</p>
            </div>
            <div class="card text-center">
                <h3 class="text-gray-400 text-sm">Total LSTM</h3>
                <p class="text-2xl font-bold text-purple-400">{{ "%.2f"|format(fila.LSTM) }}</p>
            </div>
            {% endfor %}
        </div>

        <!-- PRIMERA FILA: Bloques + Tipo -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mb-10">
            <!-- Bloques de 4 Semanas -->
            <div class="card">
                <h2 class="text-lg font-semibold mb-3 text-green-400">Bloques de 4 Semanas</h2>
                <canvas id="grafBloques"></canvas>
            </div>

            <!-- Producción por Tipo -->
            <div class="card">
                <h2 class="text-lg font-semibold mb-3 text-yellow-400">Producción por Tipo</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center">
                        <h3 class="text-blue-400 text-sm font-semibold mb-2">HW</h3>
                        <canvas id="grafTipoHW"></canvas>
                    </div>
                    <div class="text-center">
                        <h3 class="text-purple-400 text-sm font-semibold mb-2">LSTM</h3>
                        <canvas id="grafTipoLSTM"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEGUNDA FILA: Variedad + Color (HW y LSTM) -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mb-10">
            <!-- Producción por Variedad -->
            <div class="card">
                <h2 class="text-lg font-semibold mb-3 text-blue-400">Producción por Variedad</h2>
                <canvas id="grafVariedad"></canvas>
            </div>

            <!-- Producción por Color HW y LSTM -->
            <div class="card">
                <h2 class="text-lg font-semibold mb-3 text-pink-400">Producción por Color</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center">
                        <h3 class="text-blue-400 text-sm font-semibold mb-2">HW</h3>
                        <canvas id="grafColorHW"></canvas>
                    </div>
                    <div class="text-center">
                        <h3 class="text-purple-400 text-sm font-semibold mb-2">LSTM</h3>
                        <canvas id="grafColorLSTM"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
    // --- Datos Flask ---
    const dataVariedad = {{ tabla_total | tojson }};
    const dataTipo = {{ tabla_tipo | tojson }};
    const dataColor = {{ tabla_color_total | tojson }};
    const dataBloques = {{ tabla_general_bloques | tojson }};

    // --- Gráfica de Línea (Bloques de 4 Semanas) ---
    new Chart(document.getElementById("grafBloques"), {
        type: "line",
        data: {
            labels: dataBloques.map(b => b.BLOQUE),
            datasets: [
                { label: "HW", data: dataBloques.map(b => b.HW), borderColor: "#3b82f6", fill: false, tension: 0.3 },
                { label: "LSTM", data: dataBloques.map(b => b.LSTM), borderColor: "#a78bfa", fill: false, tension: 0.3 }
            ]
        },
        options: { 
            responsive: true,
            plugins: { legend: { labels: { color: "#fff" } } },
            scales: { x: { ticks: { color: "#ccc" } }, y: { ticks: { color: "#ccc" } } }
        }
    });

    // --- Gráfica de Barras (Variedad) ---
    new Chart(document.getElementById("grafVariedad"), {
        type: "bar",
        data: {
            labels: dataVariedad.map(v => v.VARIEDAD),
            datasets: [
                { label: "HW", data: dataVariedad.map(v => v.HW), backgroundColor: "rgba(59,130,246,0.7)" },
                { label: "LSTM", data: dataVariedad.map(v => v.LSTM), backgroundColor: "rgba(168,85,247,0.7)" }
            ]
        },
        options: { 
            responsive: true,
            plugins: { legend: { labels: { color: "#fff" } } },
            scales: { x: { ticks: { color: "#ccc" } }, y: { ticks: { color: "#ccc" } } }
        }
    });

    // --- Gráficas de Pastel (Tipo) ---
    new Chart(document.getElementById("grafTipoHW"), {
        type: "pie",
        data: {
            labels: dataTipo.map(t => t.TIPO),
            datasets: [{
                data: dataTipo.map(t => t.HW),
                backgroundColor: ["#3b82f6","#8b5cf6","#10b981","#f59e0b","#ef4444"]
            }]
        },
        options: { plugins: { legend: { labels: { color: "#fff" } } } }
    });

    new Chart(document.getElementById("grafTipoLSTM"), {
        type: "pie",
        data: {
            labels: dataTipo.map(t => t.TIPO),
            datasets: [{
                data: dataTipo.map(t => t.LSTM),
                backgroundColor: ["#6366f1","#a855f7","#14b8a6","#fbbf24","#f43f5e"]
            }]
        },
        options: { plugins: { legend: { labels: { color: "#fff" } } } }
    });

    // --- Gráficas de Dona (Color HW y LSTM) ---
    new Chart(document.getElementById("grafColorHW"), {
        type: "doughnut",
        data: {
            labels: dataColor.map(c => c.COLOR),
            datasets: [{
                data: dataColor.map(c => c.HW),
                backgroundColor: ["#22d3ee","#a78bfa","#f472b6","#facc15","#4ade80","#fb923c"]
            }]
        },
        options: { plugins: { legend: { labels: { color: "#fff" } } } }
    });

    new Chart(document.getElementById("grafColorLSTM"), {
        type: "doughnut",
        data: {
            labels: dataColor.map(c => c.COLOR),
            datasets: [{
                data: dataColor.map(c => c.LSTM),
                backgroundColor: ["#6366f1","#a855f7","#14b8a6","#fbbf24","#f43f5e","#ef4444"]
            }]
        },
        options: { plugins: { legend: { labels: { color: "#fff" } } } }
    });

</script>

</body>
</html>






